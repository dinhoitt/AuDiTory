# configs/train_config.yaml

data:
  features_dir: "/content/drive/MyDrive/Colab Notebooks/ECCV2026/SonicStory_Features"
  features_json: "dataset_features.json"
  max_mel_length: 8192

model:
  pretrained_model: "runwayml/stable-diffusion-v1-5"
  audio_encoder:
    mel_channels: 128
    hidden_dim: 512
    output_dim: 768
    num_layers: 6
    num_heads: 8
    output_seq_len: 77  # CLIP과 동일하게 변경
  freeze_unet: true
  use_lora: false
  use_consistent_attention: true  # Consistent Self-Attention for character consistency
  num_frames: 4  # Number of frames in storyboard
  attention_mode: "first"  # "first" (첫 장 참조) or "mutual" (상호 참조)
  align_weight: 1.0  # Audio-Text Alignment Loss 가중치 (Audio가 Text 공간에 정렬되도록)

training:
  batch_size: 4
  gradient_accumulation_steps: 8  # effective batch = 32
  learning_rate: 0.000005
  num_epochs: 100
  warmup_steps: 0
  save_every: 1
  eval_every: 5
  conditioning_mode: "both"  # "audio", "text", "both"

seed: 42
mixed_precision: "fp32"
output_dir: "/content/drive/MyDrive/Colab Notebooks/ECCV2026/checkpoints"